<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>比特币原理 - cuzz&#039;s blog</title><meta description="博客记录"><meta property="og:type" content="blog"><meta property="og:title" content="比特币原理"><meta property="og:url" content="https://blog.cuzz.site/2022/03/19/%E6%AF%94%E7%89%B9%E5%B8%81%E5%8E%9F%E7%90%86/"><meta property="og:site_name" content="cuzz&#039;s blog"><meta property="og:description" content="博客记录"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.cuzz.site/img/og_image.png"><meta property="article:published_time" content="2022-03-19T11:54:59.000Z"><meta property="article:author" content="cuzz"><meta property="article:tag" content="比特币"><meta property="article:tag" content="数字加密"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.cuzz.site/2022/03/19/%E6%AF%94%E7%89%B9%E5%B8%81%E5%8E%9F%E7%90%86/"},"headline":"cuzz's blog","image":["https://blog.cuzz.site/img/og_image.png"],"datePublished":"2022-03-19T11:54:59.000Z","author":{"@type":"Person","name":"John Doe"},"description":"比特币是一种数字货币，是一种分散的系统，它将交易记录在称为区块链的分布式账本中。 比特币矿工运行复杂的计算机设备来解决复杂的谜题，以确认称为区块的交易组；成功后，这些区块将被添加到区块链记录中，矿工将获得少量比特币的奖励。 比特币市场的其他参与者可以通过加密货币交易所或点对点买卖代币。"}</script><link rel="canonical" href="https://blog.cuzz.site/2022/03/19/%E6%AF%94%E7%89%B9%E5%B8%81%E5%8E%9F%E7%90%86/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/5.13.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.0.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="cuzz&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/likes">Likes</a><a class="navbar-item" href="/images">Images</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/cuzz1"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2022-03-19T11:54:59.000Z" title="2022-03-19T11:54:59.000Z">2022-03-19</time></span><span class="level-item"><a class="link-muted" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a></span><span class="level-item">15 minutes read (About 2320 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">比特币原理</h1><div class="content"><p>比特币是一种数字货币，是一种分散的系统，它将交易记录在称为区块链的分布式账本中。 比特币矿工运行复杂的计算机设备来解决复杂的谜题，以确认称为区块的交易组；成功后，这些区块将被添加到区块链记录中，矿工将获得少量比特币的奖励。 比特币市场的其他参与者可以通过加密货币交易所或点对点买卖代币。</p>
<a id="more"></a>

<h2 id="比特币：数字货币"><a href="#比特币：数字货币" class="headerlink" title="比特币：数字货币"></a>比特币：数字货币</h2><p>比特币起源于2008年11月1日，中本聪在《白皮书》提出的一种去中心化的电子记账系统。</p>
<p>例如：在系统中有A、B、C和D 一共4人，A转给B账户10BTC，B转给C账户5BTC，C转给D账户2BTC，</p>
<ul>
<li>每次转账都需要把记录广播给其他</li>
<li>我们会对转账记录进行打包成区块（大小为1M，大概可以存4000多条交易记录），在区块连接成链</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   +----------+    +----------+    +----------+</span><br><span class="line">   | X ---&gt; X |    | A ---&gt; B |    | X ---&gt; X |</span><br><span class="line">-- | X ---&gt; X | -- | B ---&gt; C | -- | X ---&gt; X | --</span><br><span class="line">   | X ---&gt; X |    | C ---&gt; D |    | X ---&gt; X |</span><br><span class="line">   +----------+    +----------+    +----------+ </span><br></pre></td></tr></table></figure>

<p>我们需要解决以下问题：</p>
<ul>
<li>以谁的为准？因为我们广播的时候会有延迟，不同的人收到的交易顺序不太一样。</li>
<li>为什么要记账，为什么别人广播给我，我就花我自己电脑资源把帮他记账？</li>
<li>如何防止伪造，A广播了一条支付B的记录，我们如何确定A真的支付给B?</li>
</ul>
<p>其实记账是有奖励的，每次转账需要支付一点手续费的，并且打包的人有奖励，每10分钟打包一次，每次打包有50个，每经过4年打包奖励减半，我们可以算出一共有多少个BTC。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">50(每10分钟) * 6(每小时6个10分钟) * 24(每天24小时) * 365 * 4(前4年) * (1 + 1&#x2F;2 + 1&#x2F;4 + 1&#x2F;8 + ...) &#x3D; 2100万个</span><br></pre></td></tr></table></figure>

<p>以谁的打包为准：工作量证明，做一个很难的计算我们俗称挖矿。</p>
<h2 id="挖矿原理"><a href="#挖矿原理" class="headerlink" title="挖矿原理"></a>挖矿原理</h2><p>1、哈希函数：sha256</p>
<ul>
<li>sha256(“apple”) = 1010…..1（256位二进制）</li>
<li>正向算很容易，反算特别困难</li>
</ul>
<p>2、具体原理</p>
<p>每个区块包含区块头和交易信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   +----------+    +----------+    +----------------+</span><br><span class="line">   |          |    |          |    |  Block Header  |</span><br><span class="line">   |----------|    | ---------|    | ---------------|</span><br><span class="line">   | X ---&gt; X |    | A ---&gt; B |    |                |</span><br><span class="line">-- | X ---&gt; X | -- | B ---&gt; C | -- |   Transaction  | ----</span><br><span class="line">   | X ---&gt; X |    | C ---&gt; D |    |                |</span><br><span class="line">   +----------+    +----------+    +----------------+ </span><br></pre></td></tr></table></figure>

<p>生成新区块的过程：</p>
<ul>
<li>需要计算一个字符串：前块的头部+张贴信息+时间戳+随机数</li>
<li>对这个字符串做两次Hash计算：Hash = sha256(sha256(字符串))</li>
<li>要求计算出来的结果前n为都为 0（通过改变随机数来使计算结果前n位为0）。</li>
</ul>
<p>3、难度的确定：保证每10分钟出现一个块，通过改变 n 的大小</p>
<p>比如有10000台矿机，每台矿机的计算能量为 14T/s，总共计算能力为 </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10000 * 14T&#x2F;s &#x3D; 1.4 * 10^13 次&#x2F;s</span><br><span class="line">10分钟计算的次数 &#x3D; (1.4 * 10^13 次&#x2F;s) * (600s) &#x3D; 8 * 10^19</span><br></pre></td></tr></table></figure>

<p>通过概率，我们这知道一共需要计算 2^n 次</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&#x2F;2 * 1&#x2F;2 * ... * 1&#x2F;2 &#x3D; (1&#x2F;2)^n --&gt; 2^n</span><br></pre></td></tr></table></figure>

<p>从而可以计算出 n = 66</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2^n &#x3D; 8 * 10^19</span><br></pre></td></tr></table></figure>

<h2 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h2><p>1、传统的认证方式有：人脸、签名、指纹等，在计算机系统这些都可以进行拷贝伪造。</p>
<p>2、电子签名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">随机数 ---&gt; 私钥 ---&gt; 公钥 ---&gt; 地址</span><br></pre></td></tr></table></figure>

<ul>
<li>首先通过一个随机数可以得出一个私钥，私钥可以计算出公钥</li>
<li>私钥是保密的，公钥和地址可以公开</li>
<li>非对称密钥中， 一般是（对方的）公钥加密，（自己的）私钥解密，或者（自己的）私钥签名，（对方的）公钥验签名</li>
</ul>
<p>例子：比如 A 需要付给 B 账户 10 个 BTC，具体过程如下：</p>
<ul>
<li>对“A付给B账户10个BTC” 进行Hash（sha256）计算得到“摘要”，接着“摘要”进行私钥生成一个“签名”</li>
<li>A进行广播，把“A付给B账户10个BTC”记录和“公钥”和“签名”这3个广播出去</li>
<li>其他接受到这条消息的人会对“A付给B账户10个BTC”进行Hash计算得到“摘要1”，然后用公钥验证签名到“摘要2”，然后确认这两个“摘要”是否相等。</li>
</ul>
<h2 id="双重支付问题"><a href="#双重支付问题" class="headerlink" title="双重支付问题"></a>双重支付问题</h2><p>1、余额检查：追溯</p>
<p>比如 A 需要转给 D 账号10个 BTC：</p>
<p>会查看以前链的所有记录，发现A获得50个，有支付20个，就知道还剩30个，够支付给D账号10个。</p>
<p>那么这条消息就会被网络所接受。</p>
<p>如果现在A 需要转给 D 账号60个 BTC，发现不余额不够，这条消广播出去就不会被接受。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">     +----------+    +----------+    +----------+</span><br><span class="line">---- | X ---&gt; X | -- | B ---&gt; A | -- | A ---&gt; C | ----</span><br><span class="line">     +----------+    +----------+    +----------+ </span><br><span class="line">                       A获得50BTC       A支付20</span><br></pre></td></tr></table></figure>

<p>2、双重支付</p>
<p>比如“A支付给B账号10个BTC”，同时”A支付给C账号10个BTC”。</p>
<p>当广播出去之后，有的人会先接受到“A支付给B账号10个BTC“这条消息，然后拒绝”A支付给C账号10个BTC”这条消息，有的人刚好相反。</p>
<p>然后这写人同时在打包新的区块。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   +----------+    +----------+    +----------+</span><br><span class="line">-- | X ---&gt; X | -- | X ---&gt; Y | -- | A ---&gt; B | ----</span><br><span class="line">   +----------+    +----------+    +----------+ </span><br></pre></td></tr></table></figure>

<p>如果刚好有人计算出新的区块的人，是接受“A支付给B账号10个BTC”这条消息，就会被打包好链接到主链上，然后发现已经有了新块了，其他人就会放弃当前块，那么”A支付给C账号10个BTC”不会被确认。</p>
<p>所有当有人给我们转账的时候，我们不能以为就打款成功了，需要等到这新块的形成，并且接到主链才才算成功。</p>
<h2 id="防止篡改"><a href="#防止篡改" class="headerlink" title="防止篡改"></a>防止篡改</h2><p>1、最长链原则</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">                                     +----------+    </span><br><span class="line">                                     |          |</span><br><span class="line">     +----------+    +----------+    +----------+</span><br><span class="line">---- | X ---&gt; X | -- | X ---&gt; Y | -- </span><br><span class="line">     +----------+    +----------+    +----------+ </span><br><span class="line">                                     |          |</span><br><span class="line">                                     +----------+    </span><br></pre></td></tr></table></figure>

<p>当同时产生两个区块，不同的人会接到不同的广播，这个时候接到的链可能不一样。</p>
<p>但他们先不管，等计算到下一个区块产生时候，这个时候，此时上面的链比下面更长，广播出去之后，下面的人就会重新站队，会到上面的链。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">                                     +----------+    +----------+</span><br><span class="line">                                     |          | -- |          |</span><br><span class="line">     +----------+    +----------+    +----------+    +----------+</span><br><span class="line">---- | X ---&gt; X | -- | X ---&gt; Y | -- </span><br><span class="line">     +----------+    +----------+    +----------+ </span><br><span class="line">                                     |          |</span><br><span class="line">                                     +----------+    </span><br></pre></td></tr></table></figure>

<p>2、防改</p>
<p>如果你需要篡改某天链的信息的，你需要把 A 支付给 B 的信息，篡改为 A 支付给 C，你需要计算出一条比主链更长的篡改链才能成功，这个时候你一个人的算力要大于其它所有的算力才能篡改成功。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">     +----------+    +----------+    +----------+</span><br><span class="line">---- | X ---&gt; X | -- | A ---&gt; B | -- | X ---&gt; X | ---&gt; 原来的主链</span><br><span class="line">     +----------+    +----------+    +----------+ </span><br><span class="line">                     +----------+    +----------+    +----------+</span><br><span class="line">                     | A ---&gt; C | -- | X ---&gt; X | -- | X ---&gt; X | ---&gt; 篡改链</span><br><span class="line">                     +----------+    +----------+    +----------+ </span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>1、比特币是怎么发行的</p>
<ul>
<li>新比特币作为对矿工的奖励进入比特币网络进行流通</li>
<li>没生成21万个区块，奖励金额减半</li>
<li>从第0个区块开始的21万个区块，每生成一个区块矿工获得50比特币作为奖励</li>
<li>从第693万个区块开始，对矿工的奖励为0，也就是不再有新的比特币流入比特币<br>网络，</li>
<li>到时，累计有2100万比特币流入到了比特币网络，矿工的收入将完全来自每笔比特币转账交易的交易费，交易费只是比特币在账户之间转移，不是新产生的比特币</li>
</ul>
<p>2、比特币存在什么地方</p>
<ul>
<li>比特币一