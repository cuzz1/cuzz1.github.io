<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Go语言入门笔记 - Hexo</title><meta description="课程导论 特点 没有“对象”，没有继承，没有泛型，没有 try&amp;#x2F;catch 有接口，函数式编程，CSP 并发模型（goroutine + channel） 语法简单   基本语法 变量 选择，循环 指针，数组，容器   面向接口 结构体 duck typing 的概念 组合的思想   函数式编程 闭包的概念   工程化 资源管理，错误处理 测试和文档 性能调优   并发编程 goroutine 和"><meta property="og:type" content="blog"><meta property="og:title" content="Go语言入门笔记"><meta property="og:url" content="http://blog.cuzz.site/2019/10/11/Go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="课程导论 特点 没有“对象”，没有继承，没有泛型，没有 try&amp;#x2F;catch 有接口，函数式编程，CSP 并发模型（goroutine + channel） 语法简单   基本语法 变量 选择，循环 指针，数组，容器   面向接口 结构体 duck typing 的概念 组合的思想   函数式编程 闭包的概念   工程化 资源管理，错误处理 测试和文档 性能调优   并发编程 goroutine 和"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://blog.cuzz.site/img/og_image.png"><meta property="article:published_time" content="2019-10-11T15:59:59.000Z"><meta property="article:modified_time" content="2020-08-21T12:42:19.193Z"><meta property="article:author" content="John Doe"><meta property="article:tag" content="Go"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.cuzz.site/2019/10/11/Go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/"},"headline":"Hexo","image":["http://blog.cuzz.site/img/og_image.png"],"datePublished":"2019-10-11T15:59:59.000Z","dateModified":"2020-08-21T12:42:19.193Z","author":{"@type":"Person","name":"John Doe"},"description":"课程导论 特点 没有“对象”，没有继承，没有泛型，没有 try&#x2F;catch 有接口，函数式编程，CSP 并发模型（goroutine + channel） 语法简单   基本语法 变量 选择，循环 指针，数组，容器   面向接口 结构体 duck typing 的概念 组合的思想   函数式编程 闭包的概念   工程化 资源管理，错误处理 测试和文档 性能调优   并发编程 goroutine 和"}</script><link rel="canonical" href="http://blog.cuzz.site/2019/10/11/Go%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.0.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T15:59:59.000Z" title="2019-10-11T15:59:59.000Z">2019-10-11</time><span class="level-item"><a class="link-muted" href="/categories/Go/">Go</a></span><span class="level-item">29 minutes read (About 4321 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Go语言入门笔记</h1><div class="content"><h2 id="课程导论"><a href="#课程导论" class="headerlink" title="课程导论"></a>课程导论</h2><ul>
<li>特点<ul>
<li>没有“对象”，没有继承，没有泛型，没有 try/catch</li>
<li>有接口，函数式编程，CSP 并发模型（goroutine + channel）</li>
<li>语法简单</li>
</ul>
</li>
<li>基本语法<ul>
<li>变量</li>
<li>选择，循环</li>
<li>指针，数组，容器</li>
</ul>
</li>
<li>面向接口<ul>
<li>结构体</li>
<li>duck typing 的概念</li>
<li>组合的思想</li>
</ul>
</li>
<li>函数式编程<ul>
<li>闭包的概念</li>
</ul>
</li>
<li>工程化<ul>
<li>资源管理，错误处理</li>
<li>测试和文档</li>
<li>性能调优</li>
</ul>
</li>
<li>并发编程<ul>
<li>goroutine 和 channel</li>
<li>理解调度器</li>
</ul>
</li>
</ul>
<a id="more"></a> 

<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认变量值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">variableZeroValue</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a <span class="keyword">int</span></span><br><span class="line">    <span class="keyword">var</span> s <span class="keyword">string</span></span><br><span class="line">    fmt.Println(a, s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义变量值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">variableInitialValue</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a, b <span class="keyword">int</span> = <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">    <span class="keyword">var</span> s <span class="keyword">string</span> = <span class="string">&quot;abc&quot;</span></span><br><span class="line">    fmt.Println(a, b, s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量推断</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">variableTypeDeduction</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a, b, c = <span class="number">1</span>, <span class="string">&quot;abc&quot;</span>, <span class="literal">true</span></span><br><span class="line">    fmt.Println(a, b, c)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量推断简写</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">variableShorter</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a, b, c := <span class="number">1</span>, <span class="string">&quot;abc&quot;</span>, <span class="literal">true</span></span><br><span class="line">    fmt.Println(a, b, c)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量定义不能使用 :=</span></span><br><span class="line"><span class="comment">// b := 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方便定义多个</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    b = <span class="string">&quot;abc&quot;</span></span><br><span class="line">    c = <span class="number">1</span></span><br><span class="line">    d = <span class="literal">true</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    variableZeroValue()</span><br><span class="line">    variableInitialValue()</span><br><span class="line">    variableTypeDeduction()</span><br><span class="line">    variableShorter()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="内建变量类型"><a href="#内建变量类型" class="headerlink" title="内建变量类型"></a>内建变量类型</h3><ul>
<li>bool, stiring</li>
<li>(u)int, (u)int8, (u)int16, (u)int32, (u)int64, uintptr</li>
<li>byte, rune</li>
<li>float32, float64, complex64, complex128</li>
</ul>
<h3 id="常量与枚举"><a href="#常量与枚举" class="headerlink" title="常量与枚举"></a>常量与枚举</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tri</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a, b := <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">    <span class="keyword">var</span> c <span class="keyword">int</span></span><br><span class="line">    <span class="comment">// 先把 int 转 float64 再转回 int</span></span><br><span class="line">    c = <span class="keyword">int</span>(math.Sqrt(<span class="keyword">float64</span>(a*a + b*b)))</span><br><span class="line">    fmt.Println(c)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义常量</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">consts</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> c <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 指定类型, 下面需要强转为 float64</span></span><br><span class="line">    <span class="comment">// const a, b int = 3, 4</span></span><br><span class="line">    <span class="comment">// c = int(math.Sqrt(float64(a*a + b*b)))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不指定类型, 不需要强转为 float64</span></span><br><span class="line">    <span class="keyword">const</span> a, b = <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">    c = <span class="keyword">int</span>(math.Sqrt(a*a + b*b))</span><br><span class="line">    fmt.Println(c)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义枚举</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">enums</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//const (</span></span><br><span class="line">    <span class="comment">//    cpp = 0</span></span><br><span class="line">    <span class="comment">//    java = 1</span></span><br><span class="line">    <span class="comment">//    python = 2</span></span><br><span class="line">    <span class="comment">//    golang = 3</span></span><br><span class="line">    <span class="comment">//)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 iota 自增加，与上面一样</span></span><br><span class="line">    <span class="keyword">const</span> (</span><br><span class="line">        cpp = <span class="literal">iota</span></span><br><span class="line">        java</span><br><span class="line">        python</span><br><span class="line">        golang</span><br><span class="line">        _ <span class="comment">// 跳开 4</span></span><br><span class="line">        javascript</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    fmt.Println(cpp, java, python, golang, javascript) <span class="comment">// 0 1 2 3 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// b, kb, mb, gb, tb, pb</span></span><br><span class="line">    <span class="keyword">const</span> (</span><br><span class="line">        b = <span class="number">1</span> &lt;&lt; (<span class="number">10</span> * <span class="literal">iota</span>)</span><br><span class="line">        kb</span><br><span class="line">        mb</span><br><span class="line">        gb</span><br><span class="line">        tb</span><br><span class="line">        pb</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    fmt.Println(b, kb, mb, gb, tb, pb) <span class="comment">// 1 1024 1048576 1073741824 1099511627776 1125899906842624</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    tri()</span><br><span class="line">    consts()</span><br><span class="line">    enums()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// if</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">read</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">const</span> filename = <span class="string">&quot;abc.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取文件</span></span><br><span class="line">    contents, err := ioutil.ReadFile(filename)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%s\n&quot;</span>, contents)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 也可以这样写</span></span><br><span class="line">    <span class="keyword">if</span> contents, err := ioutil.ReadFile(filename); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;%s\n&quot;</span>, contents)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// switch</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">eval</span><span class="params">(a, b <span class="keyword">int</span>, op <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> result <span class="keyword">int</span></span><br><span class="line">    <span class="comment">// switch 会自动 break, 除非使用 fallthrough</span></span><br><span class="line">    <span class="keyword">switch</span> op &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;+&quot;</span>:</span><br><span class="line">        result = a + b</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;-&quot;</span>:</span><br><span class="line">        result = a - b</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;*&quot;</span>:</span><br><span class="line">        result = a * b</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        result = a / b</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">panic</span>(<span class="string">&quot;unsupported operator: &quot;</span> + op)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// switch</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">grade</span><span class="params">(score <span class="keyword">int</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// switch 后面没有表达式</span></span><br><span class="line">    <span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> score &lt; <span class="number">0</span> || score &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="built_in">panic</span>(<span class="string">&quot;wrong score&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> score &lt; <span class="number">60</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;E&quot;</span></span><br><span class="line">    <span class="keyword">case</span> score &lt; <span class="number">70</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;D&quot;</span></span><br><span class="line">    <span class="keyword">case</span> score &lt; <span class="number">80</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;C&quot;</span></span><br><span class="line">    <span class="keyword">case</span> score &lt; <span class="number">90</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;B&quot;</span></span><br><span class="line">    <span class="keyword">case</span> score &lt;= <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;A&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    read()</span><br><span class="line">    fmt.Println(eval(<span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;+&quot;</span>)) <span class="comment">// 3</span></span><br><span class="line">    grade(<span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转为二进制</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">convertToBin</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    res := <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> ; n &gt; <span class="number">0</span>; n /= <span class="number">2</span> &#123;</span><br><span class="line">        lsb := n % <span class="number">2</span></span><br><span class="line">        res = strconv.Itoa(lsb) + res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印文件</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printFile</span><span class="params">(fileName <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    file, err := os.Open(fileName)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    scanner := bufio.NewScanner(file)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">        fmt.Println(scanner.Text())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 死循环</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">forever</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;forever&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(</span><br><span class="line">        convertToBin(<span class="number">5</span>),</span><br><span class="line">        convertToBin(<span class="number">13</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    printFile(<span class="string">&quot;abc.txt&quot;</span>);</span><br><span class="line">    forever()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回多个值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">div</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a / b, a % b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以对返回值命名</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">div2</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(q, r <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a / b, a % b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回 error</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">eval</span><span class="params">(a, b <span class="keyword">int</span>, op <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">int</span>, error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> op &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;+&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> a + b, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;-&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> a - b, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;*&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> a * b, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> a / b, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, fmt.Errorf(<span class="string">&quot;unsupported opration: %s&quot;</span>, op)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用函数式编程</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">apply</span><span class="params">(op <span class="keyword">func</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">int</span>, <span class="title">a</span>, <span class="title">b</span> <span class="title">int</span>) <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> op(a, b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可变参数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(numbers ...<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    sum := <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> numbers &#123;</span><br><span class="line">        sum += numbers[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pow</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(math.Pow(<span class="keyword">float64</span>(a), <span class="keyword">float64</span>(b)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    i, i2 := div(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">    fmt.Println(i, i2)</span><br><span class="line"></span><br><span class="line">    q, r := div2(<span class="number">5</span>, <span class="number">3</span>)</span><br><span class="line">    fmt.Println(q, r)</span><br><span class="line"></span><br><span class="line">    res, err := eval(<span class="number">1</span>, <span class="number">2</span>, <span class="string">&quot;&amp;&quot;</span>) <span class="comment">// unsupported opration: &amp;</span></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(res)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(apply(pow, <span class="number">2</span>, <span class="number">2</span>)) <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)) <span class="comment">// 10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用指针</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap</span><span class="params">(a *<span class="keyword">int</span>, b *<span class="keyword">int</span>)</span></span>  &#123;</span><br><span class="line">    *b, *a = *a, *b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">swap2</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> b, a</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a, b := <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">    swap(&amp;a, &amp;b)</span><br><span class="line">    fmt.Println(a, b) <span class="comment">// 4 3</span></span><br><span class="line"></span><br><span class="line">    a, b = <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">    a, b = swap2(a, b)</span><br><span class="line">    fmt.Println(a, b) <span class="comment">// 4 3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数组、切片和容器"><a href="#数组、切片和容器" class="headerlink" title="数组、切片和容器"></a>数组、切片和容器</h2><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组定义</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">defineArray</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义数组的方法</span></span><br><span class="line">    <span class="keyword">var</span> arr1 [<span class="number">5</span>]<span class="keyword">int</span></span><br><span class="line">    arr2 := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>&#125;</span><br><span class="line">    arr3 := [...]<span class="keyword">int</span>&#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(arr1, arr2, arr3) <span class="comment">// [0 0 0 0 0] [1 3 5] [2 4 6 8]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义二维数组</span></span><br><span class="line">    <span class="keyword">var</span> grid [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line">    fmt.Println(grid) <span class="comment">// [[0 0 0] [0 0 0]]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历数组</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printArray</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(arr); i++ &#123;</span><br><span class="line">        fmt.Println(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过 range 可以获取下标</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> arr &#123;</span><br><span class="line">        fmt.Println(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取下标和值</span></span><br><span class="line">    <span class="keyword">for</span> i, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">        fmt.Println(i, v)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只获取值, 可以使用 _ 来省略变量</span></span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [3]int 和 [5]int 是不同的类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printArray2</span><span class="params">(arr [5]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    fmt.Println(arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组是值类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printArray3</span><span class="params">(arr [5]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line">    fmt.Println(arr) <span class="comment">// [100, 0, 0, 0, 0]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传递指针</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printArray4</span><span class="params">(arr *[5]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line">    fmt.Println(*arr) <span class="comment">// [100, 0, 0, 0, 0]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    defineArray()</span><br><span class="line">    printArray()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> arr1 [<span class="number">5</span>]<span class="keyword">int</span></span><br><span class="line">    <span class="comment">// arr2 := [3]int&#123;1, 3, 5&#125;</span></span><br><span class="line">    <span class="comment">// arr3 := [...]int&#123;2, 4, 6, 8, 10&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// [3]int 和 [5]int 是不同的类型</span></span><br><span class="line">    printArray2(arr1) <span class="comment">// 在函数里面改变数组的值</span></span><br><span class="line">    <span class="comment">// printArray2(arr2) //  cannot use arr2 (type [3]int) as type [5]int in argument to printArray2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在函数里改变了数组第一个值, 后面打印还是不变，每次传递数组都是一个副本</span></span><br><span class="line">    printArray3(arr1)</span><br><span class="line">    fmt.Println(arr1) <span class="comment">// [0, 0, 0, 0, 0]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传递地址过去就会改变</span></span><br><span class="line">    printArray4(&amp;arr1)</span><br><span class="line">    fmt.Println(arr1) <span class="comment">// [100, 0, 0, 0, 0]</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 切片</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">mySlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line">    fmt.Println(<span class="string">&quot;arr[2:6] = &quot;</span>, arr[<span class="number">2</span>:<span class="number">6</span>]) <span class="comment">// arr[2:6] =  [2 3 4 5]</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;arr[:6] = &quot;</span>, arr[:<span class="number">6</span>])   <span class="comment">// arr[2:6] =  [2 3 4 5]</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;arr[2:] = &quot;</span>, arr[<span class="number">2</span>:])   <span class="comment">// arr[2:] =  [2 3 4 5 6 7]</span></span><br><span class="line">    fmt.Println(<span class="string">&quot;arr[:] = &quot;</span>, arr[:])     <span class="comment">// arr[:] =  [0 1 2 3 4 5 6 7]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateSlice</span><span class="params">(slice []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    slice[<span class="number">0</span>] = <span class="number">2019</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">extendSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line">    <span class="comment">// 我们知道 s1 只有 4 个元素, 但是 s2 还是能</span></span><br><span class="line">    s1 := arr[<span class="number">2</span>:<span class="number">6</span>]</span><br><span class="line">    s2 := s1[<span class="number">3</span>:<span class="number">5</span>]</span><br><span class="line">    fmt.Println(s1)                                <span class="comment">// [2 3 4 5]</span></span><br><span class="line">    fmt.Println(s2)                                <span class="comment">// [5 6]</span></span><br><span class="line">    fmt.Printf(<span class="string">&quot;len=%d, cap=%d&quot;</span>, <span class="built_in">len</span>(s1), <span class="built_in">cap</span>(s1)) <span class="comment">// len=4, cap=6</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">appendSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加元素如果超过了 cap, 系统会重新分配更大的底层数组</span></span><br><span class="line">    <span class="comment">// 由于值的传递关系, 必须接受 append 的返回值</span></span><br><span class="line">    s1 := arr[<span class="number">2</span>:<span class="number">6</span>]</span><br><span class="line">    s2 := <span class="built_in">append</span>(s1, <span class="number">100</span>)</span><br><span class="line">    s3 := <span class="built_in">append</span>(s2, <span class="number">100</span>)</span><br><span class="line">    s4 := <span class="built_in">append</span>(s3, <span class="number">100</span>)</span><br><span class="line">    s5 := <span class="built_in">append</span>(s4, <span class="number">100</span>)</span><br><span class="line">    fmt.Println(s1, s2, s3, s4, s5) <span class="comment">// [2 3 4 5] [2 3 4 5 100] [2 3 4 5 100 100] [2 3 4 5 100 100 100] [2 3 4 5 100 100 100 100]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 slice</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 0. 创建一个空的 slice</span></span><br><span class="line">    <span class="keyword">var</span> s []<span class="keyword">int</span></span><br><span class="line">    <span class="comment">// 发现 cap 是从 1 2 4 8 16 32... 扩大</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">        s = <span class="built_in">append</span>(s, <span class="number">1</span>+<span class="number">2</span>*i)</span><br><span class="line">        printSlice(s)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. 创建一个带有值的 slice</span></span><br><span class="line">    s1 := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    printSlice(s1) <span class="comment">// len=5, cap=5, slice=[1 2 3 4 5]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 创建一个 cap = 16</span></span><br><span class="line">    s2 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">16</span>)</span><br><span class="line">    printSlice(s2) <span class="comment">// len=16, cap=16, slice=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 创建一个 len = 10, cap = 32</span></span><br><span class="line">    s3 := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">10</span>, <span class="number">32</span>) <span class="comment">// len=10, cap=32, slice=[0 0 0 0 0 0 0 0 0 0]</span></span><br><span class="line">    printSlice(s3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">copySlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">    src := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    dst := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">16</span>)</span><br><span class="line">    fmt.Println(dst) <span class="comment">// [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span></span><br><span class="line">    <span class="built_in">copy</span>(dst, src)</span><br><span class="line">    fmt.Println(dst) <span class="comment">// [1 2 3 0 0 0 0 0 0 0 0 0 0 0 0 0]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">deleteSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 删除下标为3的元素</span></span><br><span class="line">    s := []<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line">    s = <span class="built_in">append</span>(s[:<span class="number">3</span>], s[<span class="number">4</span>:]...) <span class="comment">// s[4:]... 转换为可变参数</span></span><br><span class="line">    fmt.Println(s) <span class="comment">// [0 1 2 4 5 6 7 8]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除第一个</span></span><br><span class="line">    s1 := []<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line">    s1 = s1[<span class="number">1</span>:]</span><br><span class="line">    fmt.Println(s1) <span class="comment">// [1 2 3 4 5 6 7 8]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除最后一个</span></span><br><span class="line">    s2 := []<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line">    s2 = s2[:<span class="built_in">len</span>(s2) - <span class="number">1</span>]</span><br><span class="line">    fmt.Println(s2) <span class="comment">// [0 1 2 3 4 5 6 7]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printSlice</span><span class="params">(s []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;len=%d, cap=%d, slice=%v \n&quot;</span>, <span class="built_in">len</span>(s), <span class="built_in">cap</span>(s), s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    mySlice()</span><br><span class="line"></span><br><span class="line">    arr := [...]<span class="keyword">int</span>&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line">    slice1 := arr[:]</span><br><span class="line">    fmt.Println(<span class="string">&quot;Before update: &quot;</span>, slice1) <span class="comment">// Before update: [0 1 2 3 4 5 6 7]</span></span><br><span class="line">    updateSlice(slice1)</span><br><span class="line">    fmt.Println(<span class="string">&quot;After update: &quot;</span>, slice1) <span class="comment">// After update: [2019 1 2 3 4 5 6 7]</span></span><br><span class="line"></span><br><span class="line">    extendSlice()</span><br><span class="line"></span><br><span class="line">    appendSlice()</span><br><span class="line"></span><br><span class="line">    createSlice()</span><br><span class="line"></span><br><span class="line">    copySlice()</span><br><span class="line"></span><br><span class="line">    deleteSlice()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 map</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">defineMap</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个带默认值的 map</span></span><br><span class="line">    m1 := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个 empty map</span></span><br><span class="line">    m2 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个 nil map</span></span><br><span class="line">    <span class="keyword">var</span> m3 <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(m1, m2, m3) <span class="comment">// map[a:A b:B] map[] map[]</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历 map</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">traversingMap</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打印 key value</span></span><br><span class="line">    <span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">        fmt.Println(k, v)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只打印 key</span></span><br><span class="line">    <span class="keyword">for</span> k := <span class="keyword">range</span> m &#123;</span><br><span class="line">        fmt.Println(k)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 只打印 value</span></span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">        fmt.Println(v)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否存在</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">containMap</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    value, ok := m[<span class="string">&quot;c&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> ok &#123;</span><br><span class="line">        fmt.Println(value)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;不存在&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> value, ok := m[<span class="string">&quot;b&quot;</span>]; ok &#123;</span><br><span class="line">        fmt.Println(value)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;不存在&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除元素</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">deleteMap</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    m := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(m) <span class="comment">// map[a:A b:B]</span></span><br><span class="line">    <span class="built_in">delete</span>(m, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    fmt.Println(m) <span class="comment">// map[b:B]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    defineMap()</span><br><span class="line">    traversingMap()</span><br><span class="line">    containMap()</span><br><span class="line">    deleteMap()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>例题：查找最长不重复子串</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 查早最长不重复子串</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">lengthOfSubString</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    start := <span class="number">0</span></span><br><span class="line">    maxLength := <span class="number">0</span></span><br><span class="line">    lastOccuredMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">rune</span>]<span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, ru := <span class="keyword">range</span> []<span class="keyword">rune</span>(s) &#123;</span><br><span class="line">        <span class="keyword">if</span> lastI, ok := lastOccuredMap[ru]; ok &amp;&amp; lastI &gt;= start &#123;</span><br><span class="line">                start = lastI + <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i-start+<span class="number">1</span> &gt; maxLength &#123;</span><br><span class="line">            maxLength = i - start + <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        lastOccuredMap[ru] = i</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> maxLength</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(lengthOfSubString(<span class="string">&quot;aaa&quot;</span>))</span><br><span class="line">    fmt.Println(lengthOfSubString(<span class="string">&quot;abab&quot;</span>))</span><br><span class="line">    fmt.Println(lengthOfSubString(<span class="string">&quot;abc&quot;</span>))</span><br><span class="line">    fmt.Println(lengthOfSubString(<span class="string">&quot;abcabc&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符和字符串处理"><a href="#字符和字符串处理" class="headerlink" title="字符和字符串处理"></a>字符和字符串处理</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">runeTest</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    s := <span class="string">&quot;cuzz是我!&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, b := <span class="keyword">range</span> []<span class="keyword">byte</span>(s) &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;(%d %X %c) &quot;</span>, i, b, b)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, u := <span class="keyword">range</span> s &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;(%d %X %c) &quot;</span>, i, u, u)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, r := <span class="keyword">range</span> []<span class="keyword">rune</span>(s) &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;(%d %X %c) &quot;</span>, i, r, r)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出</span></span><br><span class="line">    <span class="comment">// (0 63 c) (1 75 u) (2 7A z) (3 7A z) (4 E6 æ) (5 98  ) (6 AF ¯) (7 E6 æ) (8 88  ) (9 91  ) (10 21 !)</span></span><br><span class="line">    <span class="comment">// (0 63 c) (1 75 u) (2 7A z) (3 7A z) (4 662F 是) (7 6211 我) (10 21 !)</span></span><br><span class="line">    <span class="comment">// (0 63 c) (1 75 u) (2 7A z) (3 7A z) (4 662F 是) (5 6211 我) (6 21 !)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 说明 range s 使用的 utf-8 遍历, 但是观察下标发现不是连续的</span></span><br><span class="line">    <span class="comment">// ascii 转为 utf-8 如:(4 E6) (5 98) (6 AF) -&gt; (4 662F)</span></span><br><span class="line">    <span class="comment">// 使用 []rune() 转换可以使下标连续输出</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    runeTest()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><ul>
<li>go 语言仅支持封装，不支持继承和多态</li>
<li>go 语言没有 class，只有 struct</li>
</ul>
<h3 id="结构体和方法"><a href="#结构体和方法" class="headerlink" title="结构体和方法"></a>结构体和方法</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义结构体, 小写对外不可见</span></span><br><span class="line"><span class="keyword">type</span> treeNode <span class="keyword">struct</span> &#123;</span><br><span class="line">    value       <span class="keyword">int</span></span><br><span class="line">    left, right *treeNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// setter, 错误, 由于 go 是传值, 不会改变</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(node treeNode)</span> <span class="title">setVal</span><span class="params">(value <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    node.value = value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(node *treeNode)</span> <span class="title">setValue</span><span class="params">(value <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    node.value = value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给结构体定义方法 node.print()</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(node treeNode)</span> <span class="title">print</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(node.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 普通的方法 print(node)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">print</span><span class="params">(node treeNode)</span></span> &#123;</span><br><span class="line">    fmt.Println(node.value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个工厂方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createNode</span><span class="params">(value <span class="keyword">int</span>)</span> *<span class="title">treeNode</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;treeNode&#123;value: value&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(node *treeNode)</span> <span class="title">traverse</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> node == <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    node.left.traverse()</span><br><span class="line">    node.<span class="built_in">print</span>()</span><br><span class="line">    node.right.traverse()</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 定义一个空的结构体</span></span><br><span class="line">    <span class="keyword">var</span> node treeNode</span><br><span class="line">    fmt.Println(node) <span class="comment">// &#123;0 &lt;nil&gt; &lt;nil&gt;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用构造器定义一个结构体</span></span><br><span class="line">    node2 := treeNode&#123;</span><br><span class="line">        value: <span class="number">1</span>,</span><br><span class="line">        left:  &amp;treeNode&#123;&#125;,   <span class="comment">// 取地址</span></span><br><span class="line">        right: <span class="built_in">new</span>(treeNode), <span class="comment">// new() 获取的是地址</span></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(node2) <span class="comment">// &#123;1 0xc00000c0c0 0xc00000c0a0&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用工厂方法创建</span></span><br><span class="line">    node3 := treeNode&#123;</span><br><span class="line">        value: <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    node3.left = createNode(<span class="number">1</span>)</span><br><span class="line">    node3.right = createNode(<span class="number">2</span>)</span><br><span class="line">    fmt.Println(node3) <span class="comment">// &#123;0 0xc00008e0a0 0xc00008e0c0&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 区别</span></span><br><span class="line">    node.<span class="built_in">print</span>() <span class="comment">// 0</span></span><br><span class="line">    <span class="built_in">print</span>(node)  <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不会改变, go 是传值</span></span><br><span class="line">    node.setVal(<span class="number">1</span>)</span><br><span class="line">    node.<span class="built_in">print</span>() <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 会改变</span></span><br><span class="line">    node.setValue(<span class="number">1</span>)</span><br><span class="line">    node.<span class="built_in">print</span>() <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">    fmt.Println()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 中顺遍历   0</span></span><br><span class="line">    <span class="comment">//         1   2</span></span><br><span class="line">    node3.traverse() <span class="comment">// 1 0 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="包和封装"><a href="#包和封装" class="headerlink" title="包和封装"></a>包和封装</h3><ul>
<li>包<ul>
<li>每个目录一个包</li>
<li>main 包包含可执行入口</li>
<li>为结构定义的方法必须放在同一包内</li>
<li>可以是不同的文件</li>
</ul>
</li>
<li>封装<ul>
<li>一般使用驼峰命名</li>
<li>首字母大写表示 public</li>
<li>首字母小写表示 private</li>
</ul>
</li>
</ul>
<p>Queue.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> queue</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Queue []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queue)</span> <span class="title">Push</span><span class="params">(v <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    *q = <span class="built_in">append</span>(*q, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queue)</span> <span class="title">Pop</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    head := (*q)[<span class="number">0</span>]</span><br><span class="line">    *q = (*q)[<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">return</span> head</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queue)</span> <span class="title">Head</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (*q)[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queue)</span> <span class="title">IsEmpty</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(*q) == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(q *Queue)</span> <span class="title">Print</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, v := <span class="keyword">range</span> *q &#123;</span><br><span class="line">        fmt.Print(v, <span class="string">&quot; &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>test.go</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;awesomeProject/queue&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个有默认值的队列</span></span><br><span class="line">    q := queue.Queue&#123;<span class="number">1</span>&#125;</span><br><span class="line">    q.Push(<span class="number">2</span>)</span><br><span class="line">    q.Push(<span class="number">3</span>)</span><br><span class="line">    q.Push(<span class="number">4</span>)</span><br><span class="line">    q.Print() <span class="comment">// 1 2 3 4</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(q.Pop()) <span class="comment">// 1</span></span><br><span class="line">    q.Print()  <span class="comment">// 2 3 4</span></span><br><span class="line"></span><br><span class="line">    q.Pop()</span><br><span class="line">    q.Pop()</span><br><span class="line">    q.Pop()</span><br><span class="line"></span><br><span class="line">    fmt.Println(q.IsEmpty()) <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>环境变量：</p>
<ul>
<li>GOROOT：go语言自带的类库</li>
<li>GOPATH：用户源代码目录<ul>
<li>src：源文件</li>
<li>pkg：build 的之后的中间文件</li>
<li>bin：可执行文件</li>
</ul>
</li>
</ul>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><h3 id="duck-typing"><a href="#duck-typing" class="headerlink" title="duck typing"></a>duck typing</h3><ul>
<li>“像鸭子走路，像鸭子叫…”，那么就是鸭子</li>
<li>描述事物的外部行为而非内部结构</li>
<li>严格说 go 属于结构化类型系统，类似 duck typing</li>
</ul>
<h3 id="接口定义和实现"><a href="#接口定义和实现" class="headerlink" title="接口定义和实现"></a>接口定义和实现</h3><p>定义一个假的发送请求，有一个 Get 方法</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> mock</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Retriever <span class="keyword">struct</span> &#123;</span><br><span class="line">    Contents <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r Retriever)</span> <span class="title">Get</span><span class="params">(url <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> url + <span class="string">&quot;hi, cuzz...&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>定义一个真正发送请求，有一个 Get 方法</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> work</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http/httputil&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Retriever <span class="keyword">struct</span> &#123;</span><br><span class="line">    UserAgent <span class="keyword">string</span></span><br><span class="line">    TimeOut time.Duration</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r Retriever)</span> <span class="title">Get</span><span class="params">(url <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    resp, err := http.Get(url)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line">    result, err := httputil.DumpResponse(resp, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">    resp.Body.Close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">string</span>(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;awesomego/retriever/mock&quot;</span></span><br><span class="line">    <span class="string">&quot;awesomego/retriever/work&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Retriever <span class="keyword">interface</span> &#123;</span><br><span class="line">    Get(url <span class="keyword">string</span>) <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入接口</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">download</span><span class="params">(r Retriever)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.Get(<span class="string">&quot;http://blog.cuzz.site&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 接口定义</span></span><br><span class="line">    <span class="comment">// var mockRetriever Retriever</span></span><br><span class="line">    <span class="comment">// mockRetriever = mock.Retriever&#123;&#125;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    mockRetriever := mock.Retriever&#123;&#125;</span><br><span class="line">    fmt.Println(download(mockRetriever))</span><br><span class="line"></span><br><span class="line">    workRetriever := work.Retriever&#123;&#125;</span><br><span class="line">    fmt.Println(download(workRetriever))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们发现在接口是调用放定义的，结构体中的接口也是隐式的，结构体满足接口中的方法，就可以说这个结构体实现了这个接口。</p>
<h3 id="接口的值类型"><a href="#接口的值类型" class="headerlink" title="接口的值类型"></a>接口的值类型</h3><p>在<code>golang</code>中，接口值是由两部分组成的，一部分是接口的类型，另一部分是该类型对应的值，我们称其为动态类型和动态值。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    mockRetriever := mock.Retriever&#123;&#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;%T, %v\n&quot;</span>, mockRetriever, mockRetriever) <span class="comment">// mock.Retriever, &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">    workRetriever := work.Retriever&#123;&#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;%T, %v\n&quot;</span>, workRetriever, workRetriever) <span class="comment">// work.Retriever, &#123; 0s&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口组合"><a href="#接口组合" class="headerlink" title="接口组合"></a>接口组合</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Retriever <span class="keyword">interface</span> &#123;</span><br><span class="line">    Get(url <span class="keyword">string</span>) <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义另一个接口</span></span><br><span class="line"><span class="keyword">type</span> Poster <span class="keyword">interface</span> &#123;</span><br><span class="line">    Post(url <span class="keyword">string</span>, params <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接口组合</span></span><br><span class="line"><span class="keyword">type</span> RetrieverAndPoster <span class="keyword">interface</span> &#123;</span><br><span class="line">    Retriever</span><br><span class="line">    Poster</span><br><span class="line">    <span class="comment">// 也可以定义其他方法</span></span><br><span class="line">    AnotherMethod()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="常用系统接口"><a href="#常用系统接口" class="headerlink" title="常用系统接口"></a>常用系统接口</h3><p><strong>1、Stringer</strong></p>
<p><code>Stringer</code>接口中的 <code>string</code> 相当与 Java <code>#toString</code> 方法</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> work</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Retriever <span class="keyword">struct</span> &#123;</span><br><span class="line">    UserAgent <span class="keyword">string</span></span><br><span class="line">    TimeOut time.Duration</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r Retriever)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;UserAgent: %v, TimeOut: %v&quot;</span>, r.UserAgent, r.TimeOut)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;awesomego/retriever/work&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    workRetriever := work.Retriever&#123;<span class="string">&quot;Mozilla/5.0&quot;</span>, time.Minute&#125;</span><br><span class="line">    fmt.Println(workRetriever) <span class="comment">// UserAgent: Mozilla/5.0, TimeOut: 1m0s</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2、Reader</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Reader <span class="keyword">interface</span> &#123;</span><br><span class="line">    Read(p []<span class="keyword">byte</span>) (n <span class="keyword">int</span>, err error)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>3、Writer</strong></p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> Writer <span class="keyword">interface</span> &#123;</span><br><span class="line">    Write(p []<span class="keyword">byte</span>) (n <span class="keyword">int</span>, err error)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h2><ul>
<li>函数是一等公民：参数，变量，返回值都可以是函数</li>
<li>高级函数</li>
<li>闭包</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个 adder 函数, 没有参数, 返回值是一个函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">()</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    sum := <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(v <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">        sum += v</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义斐波那契数列</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fibonacci</span><span class="params">()</span> <span class="title">func</span><span class="params">()</span> <span class="title">int</span></span>&#123;</span><br><span class="line">    a, b := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        fmt.Println(a)</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a := adder()</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;0 + 1 + ... + %d = %d\n&quot;</span>, i, a(i))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    f := fibonacci()</span><br><span class="line">    f() <span class="comment">// 1</span></span><br><span class="line">    f() <span class="comment">// 1</span></span><br><span class="line">    f() <span class="comment">// 2</span></span><br><span class="line">    f() <span class="comment">// 3</span></span><br><span class="line">    f() <span class="comment">// 5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="资源管理与出错处理"><a href="#资源管理与出错处理" class="headerlink" title="资源管理与出错处理"></a>资源管理与出错处理</h2><h3 id="defer-调用"><a href="#defer-调用" class="headerlink" title="defer 调用"></a>defer 调用</h3><p>你可以在 Go 函数中添加多个<code>defer</code>语句，当函数执行到最后时，这些 defer 语句会按照逆序执行（即最后一个<code>defer</code>语句将最先执行），最后该函数返回。特别是当你在进行一些打开资源的操作时，遇到错误需要提前返回，在返回前你需要关闭相应的资源，不然很容易造成资源泄露等问题。如下代码所示，我们一般写打开一个资源是这样操作的：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CopyFile</span><span class="params">(dst, src <span class="keyword">string</span>)</span> <span class="params">(w <span class="keyword">int64</span>, err error)</span></span> &#123;</span><br><span class="line">    srcFile, err := os.Open(src)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">defer</span> srcFile.Close()</span><br><span class="line"></span><br><span class="line">    dstFile, err := os.Create(dst)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">defer</span> dstFile.Close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> io.Copy(dstFile, srcFile)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>错误处理是任何语言都需要考虑到的问题，而 Go 语言在错误处理上解决得更为完善，优雅的错误处理机制是 Go 语言的一大特点。</p>
<p><strong>1、error</strong></p>
<p>Go 语言引入了一个错误处理的标准模式，即<code>error</code>接口，该接口定义如下：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> error <span class="keyword">interface</span> &#123;</span><br><span class="line">    Error() <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于大多数函数，如果要返回错误，可以将<code>error</code>作为多返回值的最后一个：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">foo</span><span class="params">(param <span class="keyword">int</span>)</span><span class="params">(ret <span class="keyword">int</span>, err error)</span></span> &#123;</span><br><span class="line">  ...  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用时的代码：</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">n, err := foo(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="comment">//  错误处理</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 使用返回值n</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2、panic</strong></p>
<ul>
<li>停止当前函数执行</li>
<li>一直向上返回，执行每一层的 defer</li>
<li>如果没有遇见 recover，程序退出</li>
</ul>
<p><strong>3、recover</strong></p>
<ul>
<li>仅在 defer 中调用</li>
<li>获取 panic 的值</li>
<li>如果无法处理，可以重新 panic</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">tryRecover</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 匿名函数里</span></span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        r := <span class="built_in">recover</span>()</span><br><span class="line">        <span class="keyword">if</span> err, ok := r.(error); ok &#123;</span><br><span class="line">            fmt.Println(<span class="string">&quot;Error occurred: &quot;</span>, err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">panic</span>(fmt.Sprintf(<span class="string">&quot;I don&#x27;t know what to do: %v&quot;</span>, r))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    a := <span class="number">1</span></span><br><span class="line">    b := <span class="number">0</span></span><br><span class="line">    fmt.Println(a / b) <span class="comment">// runtime error: integer divide by zero</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// panic(errors.New(&quot;this is an error&quot;))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// panic(123) // 如果不是一个错误的话就, 再次 panic 出去</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    tryRecover()</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><h3 id="goroutine"><a href="#goroutine" class="headerlink" title="goroutine"></a>goroutine</h3><p><strong>1、协程</strong></p>
<ul>
<li>轻量级“线程”</li>
<li>非抢占式多任务处理，由协程主动交出控制权</li>
<li>编译器/解释器/虚拟器层面的多任务</li>
<li>多个协程可能在一个或者多个线程上运行</li>
</ul>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 此时, 不会输出, main 先退出了, 必须让 main sleep</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;</span><br><span class="line">        <span class="comment">// 匿名函数</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line">                fmt.Printf(<span class="string">&quot;From %d\n&quot;</span>, i)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;(i)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    time.Sleep(time.Millisecond)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test2</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 此时不会退出, 因为不能交出控制权</span></span><br><span class="line">    <span class="keyword">var</span> arr [<span class="number">10</span>]<span class="keyword">int</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">        <span class="comment">// 匿名函数</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(i <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">            arr[i]++</span><br><span class="line">        &#125;(i)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    time.Sleep(time.Millisecond)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    test()</span><br><span class="line">    test2()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2、go 语言中的调度器</strong></p>
<p>协程可以相互通信</p>
<h3 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h3><p><code>channel</code>是<code>goroutine</code>之间互相通讯的东西。类似我们 Unix 上的管道（可以在进程间传递消息），用来<code>goroutine</code>之间发消息和接收消息。其实，就是在做<code>goroutine</code>之间的内存共享。<code>channel</code>是类型相关的，也就是说一个<code>channel</code>只能传递一种类型的值，这个类型需要在<code>channel</code>声明时指定。</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义chan</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">defineChan</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 声名一个传递int型的channel</span></span><br><span class="line">    <span class="comment">// var a chan int</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化一个int型channel</span></span><br><span class="line">    a := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从channel中获取</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            z := &lt;-a</span><br><span class="line">            fmt.Println(z)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    a &lt;- <span class="number">1</span></span><br><span class="line">    time.Sleep(time.Millisecond)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义带缓存chan</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bufChan</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化一个int型channel</span></span><br><span class="line">    a := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从channel中获取</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            <span class="comment">//z, ok := &lt;-a</span></span><br><span class="line">            <span class="comment">//if !ok &#123;</span></span><br><span class="line">            <span class="comment">//    break</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">            <span class="comment">//fmt.Println(z)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 或者使用这种, 确保发送完成</span></span><br><span class="line">            <span class="keyword">for</span> z := <span class="keyword">range</span> a &#123;</span><br><span class="line">                fmt.Println(z)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    a &lt;- <span class="number">1</span></span><br><span class="line">    a &lt;- <span class="number">2</span></span><br><span class="line">    a &lt;- <span class="number">3</span></span><br><span class="line">    a &lt;- <span class="number">4</span></span><br><span class="line">    <span class="built_in">close</span>(a) <span class="comment">// 关闭了的话, 就一直发送0</span></span><br><span class="line">    time.Sleep(time.Millisecond)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如何使用</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">chanDemo</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 定义一个只能收数据的channel, 把数据放到channel中</span></span><br><span class="line">    <span class="keyword">var</span> channels [<span class="number">10</span>]<span class="keyword">chan</span>&lt;- <span class="keyword">int</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(channels); i++ &#123;</span><br><span class="line">        channels[i] = createWorker(i)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向channel中写数据</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(channels); i++ &#123;</span><br><span class="line">        channels[i] &lt;- <span class="string">&#x27;a&#x27;</span> + i</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    time.Sleep(time.Millisecond)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createWorker</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">chan</span>&lt;- <span class="title">int</span></span> &#123;</span><br><span class="line">    c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            fmt.Printf(<span class="string">&quot;Worker %d received %c\n&quot;</span>, i, &lt;-c)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    defineChan()</span><br><span class="line">    bufChan()</span><br><span class="line">    chanDemo()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用-Channel-等待任务结束"><a href="#使用-Channel-等待任务结束" class="headerlink" title="使用 Channel 等待任务结束"></a>使用 Channel 等待任务结束</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> worker <span class="keyword">struct</span> &#123;</span><br><span class="line">    in   <span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">    done <span class="keyword">chan</span> <span class="keyword">bool</span> <span class="comment">// 使用done来通信确定完成</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">chanDemo</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> channels [<span class="number">10</span>]worker</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(channels); i++ &#123;</span><br><span class="line">        channels[i] = createWorker(i)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向channel中写数据</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(channels); i++ &#123;</span><br><span class="line">        channels[i].in &lt;- <span class="string">&#x27;a&#x27;</span> + i</span><br><span class="line">        &lt;-channels[i].done <span class="comment">// 等待channel完成</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createWorker</span><span class="params">(i <span class="keyword">int</span>)</span> <span class="title">worker</span></span> &#123;</span><br><span class="line">    w := worker&#123;</span><br><span class="line">        in:   <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>),</span><br><span class="line">        done: <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> in := <span class="keyword">range</span> w.in &#123;</span><br><span class="line">            fmt.Printf(<span class="string">&quot;Worker %d received %c\n&quot;</span>, i, in)</span><br><span class="line">            w.done &lt;- <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">return</span> w</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    chanDemo()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用-select-进行调度"><a href="#使用-select-进行调度" class="headerlink" title="使用 select 进行调度"></a>使用 select 进行调度</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math/rand&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">selectDemo</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> c1, c2 <span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">    c1, c2 = createChan(), createChan()</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="keyword">select</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> n := &lt;-c1:</span><br><span class="line">            fmt.Printf(<span class="string">&quot;from c1, val: %d\n&quot;</span>, n)</span><br><span class="line">        <span class="keyword">case</span> n := &lt;-c2:</span><br><span class="line">            fmt.Printf(<span class="string">&quot;from c2, val: %d\n&quot;</span>, n)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createChan</span><span class="params">()</span> <span class="title">chan</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    out := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        i := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            time.Sleep(time.Duration(rand.Intn(<span class="number">1000</span>)) * time.Millisecond)</span><br><span class="line">            i++</span><br><span class="line">            out &lt;- i</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    selectDemo()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Go/">Go</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" style="background-color:rgba(255,128,62,.87);border-color:transparent;color:white;" target="_blank" rel="noopener"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button is-danger donate" href="/" target="_blank" rel="noopener"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/08/17/Let&#039;s%20build%20a%20Full-Text%20Search%20engine/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Let&#039;s build a Full-Text Search engine</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/08/11/Java8%E7%9A%84%E6%B7%B1%E5%85%A5%E4%B8%8E%E5%AE%9E%E6%88%98/"><span class="level-item">Java8的深入与实战</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex" href="#课程导论"><span class="mr-2">1</span><span>课程导论</span></a></li><li><a class="is-flex" href="#基本语法"><span class="mr-2">2</span><span>基本语法</span></a><ul class="menu-list"><li><a class="is-flex" href="#HelloWorld"><span class="mr-2">2.1</span><span>HelloWorld</span></a></li><li><a class="is-flex" href="#变量定义"><span class="mr-2">2.2</span><span>变量定义</span></a></li><li><a class="is-flex" href="#内建变量类型"><span class="mr-2">2.3</span><span>内建变量类型</span></a></li><li><a class="is-flex" href="#常量与枚举"><span class="mr-2">2.4</span><span>常量与枚举</span></a></li><li><a class="is-flex" href="#条件语句"><span class="mr-2">2.5</span><span>条件语句</span></a></li><li><a class="is-flex" href="#循环"><span class="mr-2">2.6</span><span>循环</span></a></li><li><a class="is-flex" href="#函数"><span class="mr-2">2.7</span><span>函数</span></a></li><li><a class="is-flex" href="#指针"><span class="mr-2">2.8</span><span>指针</span></a></li></ul></li><li><a class="is-flex" href="#数组、切片和容器"><span class="mr-2">3</span><span>数组、切片和容器</span></a><ul class="menu-list"><li><a class="is-flex" href="#数组"><span class="mr-2">3.1</span><span>数组</span></a></li><li><a class="is-flex" href="#切片"><span class="mr-2">3.2</span><span>切片</span></a></li><li><a class="is-flex" href="#Map"><span class="mr-2">3.3</span><span>Map</span></a></li><li><a class="is-flex" href="#字符和字符串处理"><span class="mr-2">3.4</span><span>字符和字符串处理</span></a></li></ul></li><li><a class="is-flex" href="#面向对象"><span class="mr-2">4</span><span>面向对象</span></a><ul class="menu-list"><li><a class="is-flex" href="#结构体和方法"><span class="mr-2">4.1</span><span>结构体和方法</span></a></li><li><a class="is-flex" href="#包和封装"><span class="mr-2">4.2</span><span>包和封装</span></a></li><li><a class="is-flex" href="#项目结构"><span class="mr-2">4.3</span><span>项目结构</span></a></li></ul></li><li><a class="is-flex" href="#接口"><span class="mr-2">5</span><span>接口</span></a><ul class="menu-list"><li><a class="is-flex" href="#duck-typing"><span class="mr-2">5.1</span><span>duck typing</span></a></li><li><a class="is-flex" href="#接口定义和实现"><span class="mr-2">5.2</span><span>接口定义和实现</span></a></li><li><a class="is-flex" href="#接口的值类型"><span class="mr-2">5.3</span><span>接口的值类型</span></a></li><li><a class="is-flex" href="#接口组合"><span class="mr-2">5.4</span><span>接口组合</span></a></li><li><a class="is-flex" href="#常用系统接口"><span class="mr-2">5.5</span><span>常用系统接口</span></a></li></ul></li><li><a class="is-flex" href="#函数式编程"><span class="mr-2">6</span><span>函数式编程</span></a></li><li><a class="is-flex" href="#资源管理与出错处理"><span class="mr-2">7</span><span>资源管理与出错处理</span></a><ul class="menu-list"><li><a class="is-flex" href="#defer-调用"><span class="mr-2">7.1</span><span>defer 调用</span></a></li><li><a class="is-flex" href="#错误处理"><span class="mr-2">7.2</span><span>错误处理</span></a></li></ul></li><li><a class="is-flex" href="#并发编程"><span class="mr-2">8</span><span>并发编程</span></a><ul class="menu-list"><li><a class="is-flex" href="#goroutine"><span class="mr-2">8.1</span><span>goroutine</span></a></li><li><a class="is-flex" href="#channel"><span class="mr-2">8.2</span><span>channel</span></a></li><li><a class="is-flex" href="#使用-Channel-等待任务结束"><span class="mr-2">8.3</span><span>使用 Channel 等待任务结束</span></a></li><li><a class="is-flex" href="#使用-select-进行调度"><span class="mr-2">8.4</span><span>使用 select 进行调度</span></a></li></ul></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="size-small"><span>&copy; 2020 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://blog.cuzz.site',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: false,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>